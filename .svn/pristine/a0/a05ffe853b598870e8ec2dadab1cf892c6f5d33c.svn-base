# 1、nacos：配置文件发生变更
## mobile/pc
```properties
wm.cache.enabled=true
wm.cache.topic=cache.publish
wm.cache.default-spec=maximumSize=500,expireTime=300
```
## customer
```properties
wm.cache.enabled=true
wm.cache.topic=cache.publish
wm.cache.default-spec=maximumSize=10,expireTime=300
wm.cache.configs[0].cache-name=STORE_SIMPLE_INFO
wm.cache.configs[0].spec=maximumSize=100,expireTime=300
```
## empower
```properties
wm.cache.enabled=true
wm.cache.topic=cache.publish
wm.cache.default-spec=maximumSize=10,expireTime=300
```
## goods
```properties
wm.cache.enabled=true
wm.cache.topic=cache.publish
wm.cache.default-spec=maximumSize=50,expireTime=300
```
## marketing
```properties
wm.cache.enabled=true
wm.cache.topic=cache.publish
wm.cache.default-spec=maximumSize=5,expireTime=300
```
## message
```properties
wm.cache.enabled=true
wm.cache.topic=cache.publish
wm.cache.default-spec=maximumSize=5,expireTime=300
```

## order
```properties
wm.cache.enabled=true
wm.cache.topic=cache.publish
wm.cache.default-spec=maximumSize=100,expireTime=300
wm.cache.configs[0].cache-name=ORDER
wm.cache.configs[0].spec=maximumSize=1000,expireTime=60
```
## setting
```properties
wm.cache.enabled=true
wm.cache.topic=cache.publish
wm.cache.default-spec=maximumSize=5,expireTime=300
```
## mq nacos
```properties
#精准发券
spring.cloud.stream.bindings.coupon-send-customer-input.destination=q.coupon.send.customer
spring.cloud.stream.bindings.coupon-send-customer-output.destination=q.coupon.send.customer
```

## 2、新增 bff-callback服务 nacos 配置  可参考25.27
```properties
####基本配置
info.app.name=sbc-callback
info.app.description=b2b
info.build.artifact=@project.artifactId@
info.build.version=@project.version@

####Server配置
server.port=8780
management.server.port=8781
server.tomcat.basedir=/data/s2b/callback/tmp
server.maxPostSize=-1
server.maxHttpHeaderSize=102400

# mysql
wm.mysql.db.name=sbc-bff
spring.datasource.hikari.driver-class-name=com.mysql.cj.jdbc.Driver
spring.datasource.hikari.jdbc-url=jdbc:mysql://${wm.mysql.db.master.url}:${mysql_master_port}/${wm.mysql.db.name}?characterEncoding=UTF-8&zeroDateTimeBehavior=convertToNull&useUnicode=true&serverTimezone=Asia/Shanghai
spring.datasource.hikari.username=${wm.mysql.db.master.username}
spring.datasource.hikari.password=${wm.mysql.db.master.password}
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.maximum-pool-size=15
spring.datasource.hikari.idle-timeout=30000
spring.datasource.hikari.max-lifetime=60000
spring.datasource.hikari.connection-timeout=30000
# ----------------------------------------
# spring cloud
# ----------------------------------------
spring.application.name=sbc-callback

####模式#####
manager.mode=s2b

#-----------------------------------------------
# seata
#-----------------------------------------------
# 虚拟组和分组的映射
seata.service.vgroup-mapping.sbc-callback-group=default
seata.sharding.enable=false

logging.config=/data/s2b/callback/conf/logback.xml

#跨越设置
cors.allowedOrigins=${cors_allowedOrigins}

#微信视频号
wechat.proxy.sdk.appId=wx99e4b577c91bbadd
wechat.proxy.sdk.token=WanMi
wechat.proxy.sdk.encodingAesKey=RrCsP8PQxWTfXasKhzxHR9QlcUfZByDGnHTCiCT2mWs

payCallBackThreadPool.corePoolSize=32
payCallBackThreadPool.maxiNumSize=32
payCallBackThreadPool.keepAliveTime=30
payCallBackThreadPool.linkBlockQueueSize=1000

refund.call.back.corePoolSize=32
refund.call.back.maxPoolSize=32
refund.call.back.keepAliveSeconds=30
refund.call.back.queueCapacity=1000
refund.call.back.threadNamePrefix=refundExecutor-

report.corePoolSize=10
report.maxPoolSize=10
report.keepAliveSeconds=30
report.queueCapacity=1000
report.threadNamePrefix=reportExecutor-
## ------------   新增 bff-callback服务 nacos 配置END
```

## 3、优惠券es索引删除
### 3.1执行 
```properties
curl -XDELETE http://localhost:9200/es_coupon_scope，
curl -XDELETE http://localhost:9200/es_activity_coupon，
```
重新去初始化ES对应 活动优惠券（es_activity_coupon）

###3.2执行 
```properties
curl -XDELETE http://localhost:9200/es_coupon_info，
```
重新去初始化ES对应 优惠券（es_coupon_info）

## 4、jenkins 调整
推送项目 下的platform 添加：s2b_callback

## 5、app打包平台APP打包命令修改
自定义后置命令最后追加命令： 
```properties
source ~/.bash_profile;
```

## 6、boss管理后台设置-初始化es新增初始化索引功能，提供es索引全部删除重新创建索引场景使用
